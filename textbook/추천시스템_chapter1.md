# 1.1

## 계기
- 웹이 전자상 거래를 위한 매체로 사용이 크게 늘어나면서 추천 시스템 기술 개발이 이루어졌다. 관련하여 사용자가 피드백을 쉽게 제공할 수 있다는 점이 중요하다. 
대표적이고 명확한 선호도를 나타내는 피드백 방식으로 다양한 아이템에 대한 선호도를 시스템에 수치로 입력하는 형태이다. 예를 들어 별점을 부여하는 시스템

## 추천 시스템의 기본 아이디어

사용자의 상품 조회, 검색 구매와 같이 구매를 위한 일반적인 행동 등 상대적으로 명확하지 않지만, 웹을 통해서 쉽게 수집할 수 있는 피드백이 있다. 구매까지 일련의 간단한 행위를 추적하여 사용자의 관심을 짐작할 수 있다.
고객에 추가적인 행위를 요청하지 않으므로 비교적 수집하기 용이하다.

추천 시스템의 기본적인 아이디어는 이러한 다양한 소스를 활용해 고객의 관심을 추론하는 것.

과거 관심사와 성향이 미래 선택에 좋은 방향성을 제시 해주는 경우가 많기 때문에 추천 분석은 흔히 사용자와 아이템 간의 과거의 상호작용에 기반한다.


## 추천 알고리즘의 원칙과 유형

- 추천 알고리즘의 기본원칙 : 사용자와 아이템 중심의 활동 사이에 의존성에 기반하여 사용자의 미래 행동을 예측.
1. 아이템이 속해 있는 카테고리에 의한 의존성 사용.
2. 개별 아이템의 상세한 특징에 따라 의존성 사용.
3. 다양한 사용자들의 구매 또는 평가 행동을 활용해 유사한 제품에 관심 있는 비슷한 고객군을 만듦.

## 추천 시스템 유형


앞에서 설명한 내용은 이웃모델 -> 협업 필터링이라고 하는 더 광범위한 클래스에 속함.


협업필터링이란 ?

아직 평가하지 않은 평점을 예측하기 위해 여러 사용자가 이미 평가한 평점을 사용하는 것. 


실제로 다양한 유형의 보조 데이터를 활용함으로써 더욱 복잡하고 풍부한 데이터를 보유할 수 있음.

- 콘텐츠 기반 추천 시스템 : 콘텐츠는 사용자의 평가 및 아이템 속성을 의미. 사용자가 관심을 갖고 과거에 평가했거나 조회한 아이템의 속성을 기준으로 모델링할 수 있다는 것.
- 사용자가 대화식으로 자산의 관심 분야를 지정하는 지식 기반 시스템 -> 사용자 설명이 도메인 지식과 결합돼 추천 제공.
- 이외에 시간 정보, 외부 지식, 위치 정보 등 컨텍스트별 데이터를 사용할 수 있음.


# 추천 시스템의 목표

- 추천 문제를 공식화할 수 있는 방법들

## 예측 모델
- 사용자 아이템 조합에 대한 평가 값을 예측. 아이템에 대한 사용자 선호도를 나타내는 학습 데이터를 사용할 수 있다고 가정.
- m 사용자와 n 아이템 -> mXn 행렬에 해당하며 관찰된 값은 학습에 사용되고, 누락된 값은 훈련 모델을 사용해 예측된다. 
- 불완전하게 만들어진 행렬을 가지며 나머지 값은 학습 알고리즘에 의해 예측되기 때문에 행렬 완성 문제라고도 한다.

## 랭킹 모델
- 추천을 위해서는 평점을 예측할 필요 없음.
- 오히려 특정 사용자에게 k개 상위 아이템을 추천하거나, 특정 아이템에 상위 k 사용자를 결정. 전자가 더 일반적으로 사용.


첫번째 형식이 더 일반적. 두번째 사례에 대한 해결책은 다양한 사용자-아이템 조합에 대한 첫번째 형식을 해결한 다음 예측 결과의 순위를 지정해 얻을 수 있기 때문.
랭킹 모델을 활용하기 위해 예측 모델을 이용하는 것보다 직접 설계하는 것이 더 쉽고 자연스럽다.(?) -> 13장




## 제품 판매 증가는 추천 시스템의 주요 목표.
- 판매자 : 이윤 증대.  추천을 통해 아이템으로 사용자의 관심 유도, 이익증대로 이어짐.
  - 판매자의 수익을 증가시키는 것이 목적이지만, 기존에 경험하지 못했던 것처럼 느껴지는 방식으로 달성되는 경우가 많음.
  - 수익증대라는 광범위한 비지니스 중심 목표를 달성하기 위해 추천 시스템의 일반적인 운영 및 기술적 목표는 다음고 같음.



1. 관련성 : 사용자와 관련 있는 아이템 추천. 주요 운영 목표.
2. 참신성 : 추천 시스템이 사용자가 이전에 보지 못했던 아이템을 추천해줄 때 도움.
3. 의외성 : 예상하지 못한 것. 행운의 발견. 사용자는 다른 유형의 아이템에 대한 관심이 있더라도 특저 유형의 아이템만을 소비하는 경우 있음.
(일반적으로 인도 음식을 먹는 사용자에게 새로운 인도 음식점이 생겨서 추천하면 참신한 것이지만 의외는 아니다. 이 사람에게 에이티오피아 음식이 추천 됐을때, 흥미로울 수 있다는 것을
본인도 모르고 있었다면 의외성.)
  - 의외성은 판매 다양성을 높이거나 사용자의 새로운 관심이 시작되는 데에 좋은 효과가 있음. 새로운 관심 영역을 발견할 가능성이 있기 때문에 장기적이고 전략적인 이익을 가져다 준다.
  - 관련성 없을 수 있음.
4. 증가된 추천 다양성 : 추천한 리스트 안에서 같은 유형의 아이템만이 포함돼 있을 경우 선호하지 않는 위험성이 커짐. 다양할수록 최소한 하나를 선호할 가능성이 높아짐.

- 나는 이것과 관련해서 알고리즘 자체보다 실제 사용자에게 보여지는 인터페이스 등에서 이를 보완할 수 있는 것이 아닌가 생각했다. 최근 netflix 등에서 피드 자체를 굉장히 다채로운 방식으로 함으추천 다양성을 높이며, 특정 탭에 알고리즘을 통한 아이템도 추천해 관련성도 확보한다고 




사용자 : 추천은 웹사이트에 대한 전반적인 사용자 만족도를 향상시킬 수 있다. 
판매자 : 사용자의 요구 사항에 대한 통찰력을 제공하고 사용자의 환경을 개개인의 요구 사항에 맞추는 데 도움을 줄 수 있음.


- 사용자에게 특정 아이템을 추천한 이유에 대한 설명을 제공하는 것이 유용. (이 상품을 조회한 고객이 함께 조회한 상품이라는 제목으로 추천 아이템과 추천한 이유를 알려주는 것.)



# 추천 시스템의 기본 모델

1. 평점이나 구매 행동과 같은 사용자 아이템 인터렉션.
2. 텍스트로 된 프로파일 혹은 관련 키워드와 같은 사용자와 아이템에 관련한 속성 정보와 같이 두 종류의 데이터 구성.

사용자-아이템 인터랙션을 이용하는 방법을 **협업 필터링 방법**. 사용자와 아이템에 관련한 속성 정보를 이용한 방법은 **콘텐츠 기반 추천 방법**.
콘텐츠 기반 추천 방법도 평점 행렬을 사용하지만 대부분의 경우 모든 사용자가 아닌 특정 사용자의 평점에 비중.

**지식 기반 추천 시스템**에서의 추천은 특정 사용자의 조건을 기반으로 함. 과거 평점이나 구매 데이터를 이용하는 대신, 외부 지식 기반과 제한 조건을 활용.

## 협업 필터링 모델
- 여러 사용자의 평점을 협업해 추천.

### 당면하는 문제
- 평점 행렬의 분포가 고르지 않다. 
(영화를 예로 하면 대부분의 사용자는 전 세계의 영화 중 아주 일부만 봄. 그렇기 때문에 대부분의 평점은 명시되지 않음. 명시된 평점은 관측된 평점.)

### 기본구조
- 발견된 평점은 사용자 및 아이템과 매우 높은 상관관계를 나타내고 있기 때문에 명시되지 않은 평점 또한 대체가 가능하다.
(앨리스와 밥이라는 유사한 취향을 가지고 있는 사용자. 만약 두 사람 모두가 명시한 평점 이 매우 유사 -> 이 유사도 알고리즘으로 알 수 있음. 
한 사람만 특정 영화에 대해서 평가 했을때, 다른 한 사람도 유사한 평가를 내렸을 가능성이 크다고 유추할 수 있다. )
- 협업 필터링의 대부분 모델들은 아이템 간 상관관계나 사용자간 상관관계를 예측 프로세스에 활용하는 데에 중점.
- 일부 모델은 두 상관관계를 모두 활용하기도 함.
- 더 나아가 정답이 있는 데이터 훈련 모델을 만드는 방법과 같이 최적화 방법을 통해 모델을 훈련시키기도 함. (어떤 뉘앙스일까 ?) -> 구분자가 정답이 누락된 답을 유추하듯이 행렬의 빈 값을 채워넣는 역할을 한다고 함.

### 일반적인 두 접근 방법

#### 메모리 기반(이웃 기반)
-이웃을 기반으로 사용자-아이템 조합의 평점을 예측함.

```
사용자 기반 협업 필터링 : 타깃 사용자와 유사한 성향을 가지고 있는 사용자들의 평점 결과로 추천 진행.
- 타깃사용자와 유사한 사용자 정의
- 피어 그룹 평가 결과의 가중 평균을 기반으로 관측되지 않은 평점 예측.
```
```

아이템 기반 협업 필터링 : 사용자를 통해 타깃 아이템의 평점을 예측하려면 타깃 아이템과 가장 유사한 아이템 집합정의가 먼저.
- 타깃 아이템과 가장 유사한 집합 정의
- 사용자가 정의한 아이템 집합의 평점은 사용자가 타깃 아이템을 좋아할지 안 좋아할지를 결정하는 데에 쓰임.
(밥이 정의한 여러 영화에 대한 평점은 그가 아직 보지 않은 영화의 평점을 예측하는데 사용한다.)
```
- 간단하고 설명하기 쉬움. 분포가 고르지 않는다는 단점이 있음.(유사한 사용자 가운데에서 특정 영화를 찾지 못하는 경우 예측 어려움.) 평점 예측의 전체를 커버하기에는 어려울 수 있는 방법.

#### 모델 기반
- 예측 모델에 머신러닝과 데이터 마이닝 방법 이용 (decision tree, rule based model, bayesian methods, latent factor models.)


(content based model과 model based collaborative filtering에서 내가 알던 각 알고리즘들이 어떻게 쓰이고 어디에 해당하는지 잘 파악)

#### 평점의 종류
- 추천 알고리즘 설계는 평점 추적 시스템에 영향.
- 평점은 주로 순서가 정렬된 서로 다른 숫자의 인터벌 형태로 좋고 싫음을 정량화한다.

인터벌 기반 평점 
- {-2,-1,0,1,2} {1,2,3,4,5}
- 평점 표현 방식은 시스템에 따라 다를 수 있음.
- 각각의 가능한 평점은 사용자의 관심 수준을 의미한다.
- 평점 표현 방식은 제공사 별로 다를 수 있다. - 평점 척도의 불균형 또한 존재할 수 있다. (강제 선택 평가 시스템)

서수형 평점 :{강한 비동의, 비동의, 중립, 동의, 강한 동의}와 같은 순서형 범주형 값을 이용할 수 있다. 
이진 평점 : 좋거나 싫음에 대한 평가만을 할 수 있음. 0,1 혹은 지정되지 않은 값. 지정되지 않은 값은 0또는 1의 값으로만 예측해야함.


단항 평점 : 호감을 표시하고 비호감 표현에 대한 기능은 없는 경우.
- 암시적 피드백 데이터 세트의 경우 가장 흔하게 보임. 
  - 이런 경우는 고객의 선호도가 그들의 행동에 따르는 것, 평점에 기반하지 않음. 
  - 고객의 구매 행동은 단항 평점으로 표현할 수 있음. 고객이 물건을 구매할 경우 이는 그 물건에 대한 고객의 선호로 생각할 수 있음.
  - 그렇다고 해서 물건을 구매하지 않는 행위가 반드시 선호하지 않음을 의미하는 것은 아님.
  - 암시적 피드백 설정은 데이터 분류에서의 학습 문제의 행렬 완성 아날로그로 볼 수 있다고 함. (무슨말일까?)

##### 명시적 평점과 암시적 평점의 예시
- 평점 행렬은 (의미상 동일하지 않지만) 효용 행렬이라고 부르기도함. (사용자-아이템 조합의 효용성은 사용자에게 해당 아이템 추천했을때 발생하는 이익의 양) (이쪽 잘 이해는 안 감.)
- 평점이 단항인 경우의 행렬은 긍정적 선호만을 의미하기 때문에 긍정적 선호 효용 행렬이라고 부름.

- 평점 기반 효용은 아이템에 대한 부정적 선호를 알 수 있게 해줌.
- 암시적인 경우에는 표현력이 부족함.


단항 행렬
- 단항 행렬은 일반적으로 물건을 사는 행위와 같은 사용자 행동을 기반으로 만들어지기 때문에 암시적인 피드백 행렬이라고 부름.
- 단항 평점은 아이템에 대한 사용자의 비호감 여부를 알 수 없기 때문에 추천 알고리즘에 매우 큰 영향을 미침.
  - 초기항을 0으로 표현하는 방법 제안되기도 하지만, 아이템이 사용자의 취향과 맞는다면 학습 알고리즘을 통한 최종 예측 값은 0보다 훨씬 큰 값일 수 있음.
  - 초깃값 0이라는 가정에 대한 가장 큰 양의 예측 오류가 있는 항을 기반으로 함. 
  - 만약 0으로 대체하지 않는다면 치명적인 과적합 발생가능. (과적합은 평점 내 다양한 관측 결과 간의 충분한 차이가 있을때 생김.)
  - 명시적 피드백 행렬에서 평점은 **차별화된 선호도**. 암시적 피드백 행렬에서의 평점은 **덜 차별화된 신뢰도**에 해당한다.
명시적 평점 행렬
- 누락된 평점을 미리 다른 값으로 대체하는 것을 권장하지 않음.
- 0 , 행 또는 열의 평균으로 대체하는 것은 큰 바이어스를 발생시킨다.
- 단항의 경우에는 암시적 피드백 데이터에 대한 전제 가정이 아래와 같다.
```
물건 구매의 케이스와 같이 사용자는 대부분의 아이템을 사지 않을 것이다.
```
- 따라서 누락 값을 0으로 대체하는 방법은 명시적 평점 행렬보다는 다소 약한 바이어스로 이어진다.


#### 분류와 회귀 모델링의 일반화로써의 협업 필터링(여기 좀 이해 안 감.)

- 분류는 label에만 결측을 채우는 문제이고 협업필터링은 모든 열에서 결측이 존재할 수 있다라는 것 ?
- 따라서 분류와 회귀 모델링의 일반화이다?
- 협업 필터링은 예측이 항 방식으로 수행하는 분류와 회귀 모델링의 일반화.

- 협업 필터링 모델이 만들어져 있고, 평점 행렬에 추가되었다면 예측 못함. 모델 기반의 경우 더욱 심함. 하지만 최근 행렬 완성 모델은 표본에서 벗어난 사용자나 아이템 평점도 예측할 수 있게 귀납적.
- 귀납적 : 새로운 인스턴스에 대한 예측을 쉽게할 수 있는 모델 (예로 나이브 베이즈가 있음.)


## 콘텐츠 기반 추천 시스템
- 아이템의 설명 속성을 추천에 활용.
- 사용자의 평점과 구매행동이 아이템의 콘텐츠 정보와 조합됨.
```
예시 (이 경우에는 협업 필터링 사용 불가능)
- 다른 사용자의 평점 알 방법 없음.
- 특정 영화에 높은 평점.
- 특정 영화가 다른 영화들과 유사하다는 것을 아이템 속성을 통해 알 수 있으므로 이를 이용하여 추천할 수 있다.
```

- 평점과 함께 레이블 돼 있는 아이템 설명은 **'사용자별 회귀 혹은 분류 모델링 문제를 만들 때의 학습 데이터로 활용한다.'**
  - 각 사용자에게 학습 데이터는 사용자가 직접 구매하거나 작성한 아이템 설명에 해당한다. 
  - 종속 변수는 명시된 평점 혹은 구매 행동에 해당한다.
  - 학습 데이터는 특정 사용자의 분류 모델 혹은 회귀 모델을 만드는 데 사용한다.
  - 이런 사용자 특정 모델은 해당 개인이 평점이나 구매 행동이 알려지지 않은 경우에 아이템에 대한 선호를 예측한다.

### 장점
- 평점 데이터가 충분하지 않은 새로운 아이템에 대한 추천을 다룰 수 있음. (유사한 속성을 가진 다른 아이템을 평가했을 수 있기 때문) -> 지도 학습 모델에서는 아이템에 대한 평점 이력이 없다 하더라도 속성을활용해 추천에 사용할 평점을 매길 수 있다.

### 단점
- 대부분의 경우 콘텐츠 기반 방법은 키워드나 내용 때문에 명백한 추천을 제공함. (사용자가 한 번도 트겆ㅇ 키워드가 있는 아이템을 이용한 적이 없으면 그런 아이템 추천 안 함.)
  - 구성된 모델이 현재의 사용자에게 제한돼 있고 유사한 사용자의 커뮤니티 지식을 활용하지 않았기 때문. 이러한 현상은 추천 아이템의 다양성을 줄이는 바람직하지 않은 경우.
- **새로운 아이템 추천에 효과적이어도, 새로운 사용자에게 제안하는 추천은 효과적이지 않음.** 어쨌거나 사용자의 평점 이력이 있어야 하기 때문.
- 과적합이 없는 견고한 예측을 위해서는 타깃 사용자의 매우 많은 수의 평점 정보가 중요

(정리하면 특정 사용자를 기준으로 평점과 사용한 아이템 정보를 활용하여 모델링.)

폭넓은 관점
- 사용자 자신의 프로파일 정보에 관련 키워드를 명시. 추천을 제공할때 물품의 상세 정보와 매칭할 수 있음. -> 평점 안 쓰고 콜드 스타트 시나리오에 실용적이라고 함. ()
- 
